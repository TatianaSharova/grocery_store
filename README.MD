Grocery store - backend API-сервис для магазина продуктов.
Покупатели могут просматривать продукты, их категорию или подкатегория, складывать продукты в корзину, редактировать их количество в корзине или вовсе удалить отдельный продукт или очистить всю корзину сразу. Администраторы могут управлять каталогом товаров, категориями, подкатегориям, пользователями и их корзинами через интерфейс администрирования Django или API.
                
Стек: Python, Django, DRF, PostgreSQL, Pytest, Docker-compose, Gunicorn, Nginx, Prometheus, Grafana.                               
                     
___
**Как запустить проект:**

1. Клонировать репозиторий и перейти в него в командной строке:

```
git clone https://github.com/TatianaSharova/grocery_store.git
```
**_Запуск проекта через docker-compose:_**  

2. Используйте .env.example и создайте свой .env в корне проекта.                                              
3. В терминал для запуска выполните команду:

```bash
docker compose up --build  
```
При запуске проекта автоматически создается админ по вашим данным из .env, а также загружаются фикстуры в базу данных.       
4. Админка проекта станет доступна [по ссылке](http://127.0.0.1:8888/admin/)
                                         
**Доступ к API**
-----------
Анонимные пользователи могут просматривать продукты, категории и подкатегории, не могут совершать операции с корзиной.                    
Админы могут совершать CRUD операции с продуктами, категориями, подкатегориям, юзерами и корзиной.                      
Для авторизации используются токены.                                  
                                                                               
Процесс регистрации и авторизации:
1. Отправить POST-запрос с телом {"username": "name", "password": "yourpassword", "email": "email@mail.com"} на эндпоинт:
```
http://127.0.0.1:8000/api/users/
```
2. Отправить POST-запрос с телом {"username": "name", "password": "yourpassword"} на эндпоинт:
```
http://127.0.0.1:8000/api/auth/token/login/
```
Полученный в ответе токен в запросах добавить в Headers = {"Authorization": "Token yourtoken"}

**Использование API**
-----------
1. Просмотр списка товаров или определенного товара по id:

```
GET http://127.0.0.1:8000/api/products/
GET http://127.0.0.1:8000/api/products/id/
```
Предусмотрена пагинация: по 3 товара на странице.                 
2. Просмотр списка продуктовых категорий или определенной категории по id:
```
GET http://127.0.0.1:8000/api/groups/
GET http://127.0.0.1:8000/api/groups/id/
```
Предусмотрена пагинация: по 3 категории на странице.                        
3. Просмотр списка продуктовых подкатегорий или определенной подкатегории по id:
```
GET http://127.0.0.1:8000/api/types/
GET http://127.0.0.1:8000/api/types/id/
```
Предусмотрена пагинация: по 3 подкатегории на странице.                     
4. Добавление продукта в корзину (только для авторизованных пользователей):
```
POST http://127.0.0.1:8000/api/cart/
body example: {"product": "Молоко 2%", "amount": 1}
```
5. Просмотр своей корзины (только для авторизованных пользователей):
```
GET http://127.0.0.1:8000/api/cart/
```
6. Изменение количества продукта в корзине:
```
PATCH http://127.0.0.1:8000/api/cart/update-product/
body example: {"product": "Молоко 2%", "amount": 2}
```
7. Удаление продукта из корзины (только для авторизованных пользователей):
```
PATCH http://127.0.0.1:8000/api/cart/remove-product/
body example: {"product": "Молоко 2%"}
```
8. Очистка всей корзины (только для авторизованных пользователей):
```
DELETE http://127.0.0.1:8000/api/cart/clear-cart/
```
                    
Также админ может совершать CRUD-операции с категориями, подкатегориями, пользователями, товарами.

**Администрирование**
-----------
Админка находится по адресу:
```
http://127.0.0.1:8000/admin/
```
Зайдите в админку, используя созданный вами пароль и имя для админа из .env. В админ-зоне поддерживается весь функционал сервиса: можно создавать, изменять и удалять товары, категории, подкатегории, добавлять товары в корзины пользователей и редактировать их.
                            
**Тестирование**
-----------
Pytest тесты расположены в директории grocery_store/store/products/pytest_tests. Чтобы их запустить из директории grocery_store/store, выполните код:
```
pytest
```

**Мониторинг**
После запуска проекта Prometheus доступен по ссылке: http://127.0.0.1:9090/
Grafana доступна по ссылке: http://127.0.0.1:3000/

Dashboard id для postgresql: 9628
Dashboard id для NGINX: 12708 17452
                            
**Документация:**                                      
Документацию к API после запуска проекта можно посмотреть по адресам:
```
http://127.0.0.1:8000/schema/redoc/
```
```
http://127.0.0.1:8000/schema/swagger-ui/
```

### Автор
[Татьяна Шарова](https://github.com/TatianaSharova)
